{% extends 'app/admin_dashboard_base.html' %}
{% load static %}

{% block content %}
{% if messages %}
      {% for message in messages %}
          <div class="alert alert-info alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
      {% endfor %}
  {% endif %}
<div style="padding: 30px;">
    <h1 style="font-size: 28px; font-weight: bold; margin-bottom: 20px; text-align: center; color: black;">
        üè¢ Company List
    </h1>

    <div class="table-responsive" style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <table class="table table-hover align-middle text-center">
            <thead class="table-dark">
    <tr>
        <th>Company Logo</th>
        <th>Company Name</th>
        <th>Email</th>
        <th>Contact</th>
        <th>Location</th>
        <th>Industry Type</th>
        <th>Team Size</th>
        <th>Founded</th>
        <th>Joined On</th>
        <th>Status</th> <!-- Added -->
        <th>Actions</th>
    </tr>
</thead>
<tbody>
    {% for user in all_company %}
        {% if user.company_set.all %}
            {% for company in user.company_set.all %}
            <tr>
                <td>
                    {% if company.company_logo %}
                        <img src="{{ company.company_logo.url }}" alt="Logo" style="width:50px; height:50px; object-fit:cover; border-radius:6px;">
                    {% else %}
                        <span class="text-muted">No Logo</span>
                    {% endif %}
                </td>
                <td>{{ company.company_name }}</td>
                <td>{{ company.company_email }}</td>
                <td>{{ company.contact }}</td>
                <td>{{ company.city }}, {{ company.state }}</td>
                <td>{{ company.industry_type|default:"‚Äî" }}</td>
                <td>{{ company.team_size|default:"‚Äî" }}</td>
                <td>{{ company.founded_year|default:"‚Äî" }}</td>
                <td>{{ company.created_at|date:"M d, Y" }}</td>

                <!-- Status badge -->
                <td>
                    {% if user.is_verified %}
                        <span class="badge bg-success">Verified</span>
                    {% else %}
                        <span class="badge bg-secondary">Not Verified</span>
                    {% endif %}
                </td>

                <td>
    <!-- Verify / Unverify Button -->
    {% if user.is_verified %}
        <a href="{% url 'toggle_company_verification' user.id %}"
           class="btn btn-warning action-btn"
           onclick="return confirm('Mark this company as Not Verified?');">
            <i class="fas fa-times-circle"></i> Unverify
        </a>
    {% else %}
        <a href="{% url 'toggle_company_verification' user.id %}"
           class="btn btn-success action-btn"
           onclick="return confirm('Verify this company?');">
            <i class="fas fa-check-circle"></i> Verify
        </a>
    {% endif %}

    <!-- Delete Button -->
    <a href="{% url 'delete_company' company.id %}" 
       class="btn btn-danger action-btn"
       onclick="return confirm('Are you sure you want to delete this company? This will also delete all related data.')">
        <i class="fas fa-trash-alt"></i> Delete
    </a>
</td>

            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="11" class="text-muted">No company details found for {{ user.email }}</td>
            </tr>
        {% endif %}
    {% empty %}
        <tr>
            <td colspan="11" class="text-muted">No companies found</td>
        </tr>
    {% endfor %}
</tbody>

        </table>
    </div>
</div>

<style>
    .table th, .table td {
        vertical-align: middle;
        padding: 12px;
    }
    .table-hover tbody tr:hover {
        background-color: #f8f9fa;
    }
    /* Custom delete button styling */
    .delete-btn {
        border-radius: 8px; /* Rounded corners */
        padding: 4px 10px; /* Small size */
        font-size: 0.8rem;
        transition: all 0.2s ease-in-out; /* Smooth hover animation */
    }
    .delete-btn {
        border-radius: 6px;
        transition: all 0.3s ease;
    }
    .delete-btn:hover {
        background-color: #c82333;
        transform: scale(1.05);
    }
</style>
<style>
    /* Small, rounded delete button with hover animation */
    .delete-btn {
        border-radius: 6px;
        padding: 8px 8px;
        font-size: 0.8rem;
        transition: all 0.2s ease-in-out;
        display: inline-flex;
        align-items: center;
        gap: 4px; /* space between icon and text */
    }
    .delete-btn:hover {
        background-color: #c82333 !important;
        transform: scale(1.05);
    }
  /* Common style for both action buttons */
.action-btn {
    border-radius: 6px;
    padding: 6px 12px;
    font-size: 0.8rem;
    display: inline-flex;
    align-items: center;
    gap: 6px; /* Space between icon & text */
    transition: all 0.2s ease-in-out;
    margin: 4px; /* Equal spacing around each button */
}

/* Hover animations for each button type */
.btn-success:hover {
    background-color: #218838 !important;
    transform: scale(1.05);
}
.btn-warning:hover {
    background-color: #e0a800 !important;
    transform: scale(1.05);
}
.btn-danger:hover {
    background-color: #c82333 !important;
    transform: scale(1.05);
}

</style>


{% endblock %}
